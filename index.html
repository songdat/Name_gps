<!DOCTYPE html>
<html>
<head>
  <title>Send Student Location</title>
</head>
<body>
  <h2>กรอกชื่อ-สกุล,ชื่อเล่น,และระดับชั้น(ตัวอย่างเช่น นายใจดี สุขใจ บิ๊ก 1/4)</h2>
  <input type="text" id="studentName" placeholder="ชื่อ-สกุล,ชื่อเล่น,และระดับชั้น">
  <button onclick="sendLocation()">กดปุ่ม ระบุตำแหน่ง</button>

  <p id="status"></p>

  <script>
    function sendLocation() {
      const name = document.getElementById('studentName').value;
      if (!name) {
        alert('กรุณากรอกชื่อ');
        return;
      }
      if (!navigator.geolocation) {
        alert('อุปกรณ์นี้ไม่รองรับ GPS');
        return;
      }
      document.getElementById('status').innerText = 'กำลังขอพิกัด...';

      navigator.geolocation.getCurrentPosition(function(position) {
        const data = {
          name: name,
          latitude: position.coords.latitude,
          longitude: position.coords.longitude
        };

        fetch('https://script.google.com/macros/s/AKfycbyEc5N3ocKKbMAC7ya_Ve4jc8L1JyEBwjIuIncj3Y4MG2FdRhrDDdHyUJbDcSqbdcTh/exec', {
          method: 'POST',
          mode: 'no-cors',  // ป้องกันปัญหา CORS เบื้องต้น
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        })
        .then(() => {
          document.getElementById('status').innerText = 'ส่งข้อมูลเรียบร้อย';
        })
        .catch((error) => {
          document.getElementById('status').innerText = 'เกิดข้อผิดพลาด: ' + error;
        });

      }, function(error) {
        document.getElementById('status').innerText = 'ไม่สามารถรับพิกัด: ' + error.message;
      });
    }
  </script>
</body>
</html>
